<!doctype html><html>
    <head>
      <meta http-equiv="content-type" content="text/html; charset=utf-8">
      <title>OS Command Inj</title>
      <meta name="generator" content="CherryTree">
      <link rel="stylesheet" href="res/styles3.css" type="text/css" />
    </head>
    <body><div class='page'><h1 class='title'>OS Command Inj</h1><br/><strong>What is it?</strong><br />• aka shell injection<br />• execute OS commands on server running the application<br />• Exploit trust relationships to pivot attack to other systems in org<br /><strong><br />Executing Arbitrary Commands</strong><br />• Identify when a shell command is being executed, insert something in it<br />• <code>&amp; echo aiwefwlguh &amp;</code><br />   ◇ echo will echo in the output (to test where output is displayed)<br />   ◇ &amp; is seperator -&gt; command is executed after<br />   ◇ Good way of checking if there are systems in place<br />      ▪ If echo was executed<br />      ▪ if the whole thing was executed<br /><strong><br />Useful Commands</strong><br />• <code>whoami</code> = name of current user<br />• <code>uname -a</code> = OS (linux)<br />• <code>ver</code> = OS (windows)<br />• <code>ifconfig</code> = network config (add an “ /all” at the end for windows)<br />• <code>netstat -an</code> = network connections<br />• <code>ps -ef</code> = Running processes (linux)<br />• <code>tasklist</code> = Runing processes (windows)<br /><strong><br />Prevention</strong><br />• never call out OS commands from application layer<br />   ◇ Always another way of doing this<br />• If unavoidable : input validation!<br />   ◇ Allowlists<br />   ◇ insure it is correct datatype (e.g. phone number is integer)<br />   ◇ no whitespace or other syntax (alphanumeric)<br />• Don&#39;t bother trying to sanitise input by escaping shell matacharacters, there are so many ways around it</div></body></html>