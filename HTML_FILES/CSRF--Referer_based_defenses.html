<!doctype html><html>
    <head>
      <meta http-equiv="content-type" content="text/html; charset=utf-8">
      <title>Referer based defenses</title>
      <meta name="generator" content="CherryTree">
      <link rel="stylesheet" href="res/styles3.css" type="text/css" />
    </head>
    <body><div class='page'><h1 class='title'>Referer based defenses</h1><br/><strong>Overview</strong><br />• Referer header an attempt to defend against attacks<br />   ◇ Verify request originated from app&#39;s own domain<br />   ◇ Easily subject to bypasses<br />• Optional header with URL of page linked to resource being requested<br />   ◇ Usually added automatically by a browser when clicking a link or submitting a form<br />   ◇ Can withold/modify value of header<br /><strong><br />Validation of Referer depends on header being present</strong><br />• Apps often skip validation if header is omitted<br />• Attacker can craft exploit so that referer header is dropped<br />• Delete the referer tag and see if it passes, then craft an attack<br />• Use meta tag<br /><code>&lt;meta name=&quot;referrer&quot; content=&quot;never&quot;&gt;</code><br /><strong><br />Validation of Referer can be circumvented</strong><br />• Some validation isn&#39;t top notch<br />• Do they check if the URL is EXACTLY the same, or just starts or ends with the correct values?<br />   ◇ Attackers can exploit this to create variations of the domain<br />   ◇ <code>http://vulnerable-website.com.attacker-website.com/csrf-attack</code><br />   ◇ <a href="http://attacker-website.com/csrf-attack?vulnerable-website.com">http://attacker-website.com/csrf-attack?vulnerable-website.com</a><br />• Response containing your exploit can have <code>&quot;Referrer-Policy: unsafe-url&quot;</code> so the full URL is sent<br />• Change your referer history to contain a site you didn&#39;t actually visit (in script)<br /><code>history.pushState(&quot;&quot;, &quot;&quot;, &quot;/?your-lab-id.web-security-academy.net&quot;)</code></div></body></html>