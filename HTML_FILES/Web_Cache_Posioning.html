<!doctype html><html>
    <head>
      <meta http-equiv="content-type" content="text/html; charset=utf-8">
      <title>Web Cache Posioning</title>
      <meta name="generator" content="CherryTree">
      <link rel="stylesheet" href="res/styles3.css" type="text/css" />
    </head>
    <body><div class='page'><h1 class='title'>Web Cache Posioning</h1><br/><strong>Good Caching Settings</strong><br />• To protect requests that contain sensitive information the correct headers should be applied<br />• Reflected in the response<br />• <span style="text-decoration:underline;">Cache-Control: no-store no-cache</span><br />• <span style="text-decoration:underline;">max-age=0 (to clear existing cache)</span><br /><br /><strong>When Testing</strong><br />• You only really need to check for correct configuration.<br />• Are the headers set to no-cache no-store for sensitive information? Is there potential for posioning?<br />• GENERAL: Good to just check CORS, CSP and Cache headers.<br />• <code>X-Cache: hit</code> means response came from the cache<br /><br /><strong>What is it?</strong><br />• Exploit behaviour of web server &amp; cache so a harmful HTTP response served to other users.<br />• 2 phases:<br />   ◇ How to elicit a response from back-end server that contains dangerous payload<br />   ◇ Make sure their response is cached &amp; served to others.<br />• relatively new (2018)<br /><strong><br />Impact</strong><br />• Dependent on 2 factors<br />• What can the attack can get cached<br />   ◇ how harmful the payload is, what attacks are being used in conjunction<br />• Amount of traffic on the page<br />   ◇ response only served for a period of time to users visiting at that time.<br />   ◇ If no one visits the site for x amount of time, attack unsuccesfull<br />   ◇ However, you could script an attack so it re-poisons the cache indefinitley.<br /><strong><br />Prevention</strong><br />• Disable caching (if feasible i.e. if it&#39;s actually used and assists with latency issues)<br />• Restrict caching to static responses<br />• Review which headers are supported and if they&#39;re neccessary.<br />   ◇ some obscure ones might be enabled by default<br />• When implementing a cache:<br />   ◇ rewrite request &gt; excluding something from cache key for performance<br />   ◇ Don&#39;t accept fat GET requests<br />   ◇ Patch client-side vulnerabilities (regardless of whether they seem exploitable or not)</div></body></html>