<!doctype html><html>
    <head>
      <meta http-equiv="content-type" content="text/html; charset=utf-8">
      <title>SS Template Inj</title>
      <meta name="generator" content="CherryTree">
      <link rel="stylesheet" href="res/styles3.css" type="text/css" />
    </head>
    <body><div class='page'><h1 class='title'>SS Template Inj</h1><br/><strong>What is it?</strong><br />• Use native template syntax to inject malicious payload in a template<br />• Template is executed server side<br />• Template engines designed to generate web pages<br />   ◇ Combine fixed templates with volatile data<br />• Attack = user input concatenated directly into template, rather than pasased in as data<br />   ◇ Inject template directives<br />   ◇ Take control of server<br /><strong><br />Impact</strong><br />• dependent on template engine and how app uses it<br />• RCE<br />• gain read access to sensitive data<br /><strong><br />How do vulnerabilities arise?</strong><br />• User input concaetenated into tempaltes, not passed in as data<br />• Static template with placeholders for dynamic content (not usually vulnerable to SSTI)<br />• COMPARISON:<br />   ◇ <code>$output = $twig-&gt;render(&quot;Dear {first_name},&quot;, array(&quot;first_name&quot; =&gt; $user.first_name) );</code> <span style="text-decoration:underline;">OKAY</span><br />   ◇ <code>$output = $twig-&gt;render(&quot;Dear &quot; . $_GET[&#39;name&#39;]);</code> <span style="text-decoration:underline;">NOT OKAY</span> Can use : <code>http://vulnerable-website.com/?name={{bad-stuff-here}}</code><br />• Some of these features are intentional and others not<br />   ◇ Sometimes they like it like this for higher privledged users -&gt; You can just try and get access to their account.<br /><br /><strong>Prevention</strong><br />• Don&#39;t allow users to modify / submit new templates<br />   ◇ Sometimes unavoidable for business requirements<br />• Use logic-less tempalte engine (mustache)<br />   ◇ Seperate logic from presentation as much as possible<br />• Only execute users&#39; code in sandboxed environment<br />• Applying your own sandboxing</div></body></html>