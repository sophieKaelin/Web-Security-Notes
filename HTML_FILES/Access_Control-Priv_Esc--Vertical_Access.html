<!doctype html><html>
    <head>
      <meta http-equiv="content-type" content="text/html; charset=utf-8">
      <title>Vertical Access</title>
      <meta name="generator" content="CherryTree">
      <link rel="stylesheet" href="res/styles3.css" type="text/css" />
    </head>
    <body><div class='page'><h1 class='title'>Vertical Access</h1><br/><strong>Overview</strong><br />• restricts access to functionality based on TYPE of user<br />• e.g. Admin vs Basic User<br />• Gaining access to functionality not in their type is vertical privlege escalation.<br /><br /><strong>Unprotected Functionality</strong><br />• Accessing an admin only function. If the functionality isn&#39;t protected, anyone can access it<br />• View robots.txt to have a look at file structure.<br />• Security by Obscurity: concealing a less predictable URL<br />• View the HTML and scripts to see if “protected” URL&#39;s are referenced in the code<br /><br /><strong>Parameter-based access control methods</strong><br />• Some apps determine roles at login then store info in user controllable location<br />   ◇ hidden field<br />   ◇ cookie<br />   ◇ preset query string param<br />   ◇ https://insecure-website.com/login/home.jsp?admin=true<br />   ◇ https://insecure-website.com/login/home.jsp?role=1<br /><br /><strong>Broken Access control resulting from platform misconfig</strong><br />• Platform layer controls.<br />• Restrict access to specific URLs and HTTP methods based on role.<br />   ◇ DENY: POST, /admin/deleteUser, managers<br />• Non-Standard HTTP headers that can override URL of original request<br />   ◇ X-Original-URL &amp; X-Rewrite-URL /admin<br />   ◇ Order is: <a href="http://URL/X-Original-URL/REQUEST-URL">http://URL/X-Original-URL/REQUEST-URL</a><br />• /admin-roles<br />• If you have access to admin account, perform desired action and trace requests in Burp<br />   ◇ Then attempt to perform that same activity with a non-admin&#39;s cookie.<br />   ◇ Change POST request to POSTX or GET?</div></body></html>