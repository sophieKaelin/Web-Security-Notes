<!doctype html><html>
    <head>
      <meta http-equiv="content-type" content="text/html; charset=utf-8">
      <title>Blind SQL inj</title>
      <meta name="generator" content="CherryTree">
      <link rel="stylesheet" href="res/styles3.css" type="text/css" />
    </head>
    <body><div class='page'><h1 class='title'>Blind SQL inj</h1><br/>• Blind vulnerabilities are when the app doesn&#39;t return results/errors of SQL queries in the response.<br />• Techniques are more complicated<br /><strong><br />Technique</strong><br />• Change logic of query<br />   ◇ trigger a detectable difference in response<br />   ◇ e.g. new condition, or error like divide by 0<br />• Trigger time delay in process of query<br />   ◇ infer truth of condition based on time to respond<br />• Trigger out-of-band network interaction<br />   ◇ OAST techniques<br />   ◇ Last resort, very powerful<br />   ◇ e.g. place data into DNS lookup for domain you control<br /><strong><br />Triggering Conditional Responses</strong><br />• Can force true/false responses to see how the page responses<br />• Poke around at input fields/filters/custom cookies and try different inputs (&#39; or --) and check for differences in the page (what triggers the change)<br />• If you&#39;ve found a potential spot, test some TRUE/FALSE booleans to confirm<br />• Test some conditions that check if there is a table there:<br />   ◇ ‘+AND+(SELECT+’a&#39;+FROM+users+LIMIT+1)=&#39;a<br />• Test for a particular value if you know there is one there (e.g. if you know there is a user called administrator in the user table<br />   ◇ ‘+AND+(SELECT+’a&#39;+FROM+users+WHERE+username=&#39;administrator&#39;)=&#39;a<br />• Now you should test length of the value (e.g. the length of the password for the admin)<br />   ◇ and an AND+LENGTH(password&gt;1)=&#39;a and keep incrementing until the condition is false.<br />   ◇ Might be worth putting into burp intruder<br />   ◇ Add in Options -&gt; Grep Match -&gt; the sign that it is positive/negative (e.g Welcome Home!)<br />• Once you&#39;ve got the length, repeat the same process with each character.<br />   ◇ SUBSTRING(string, start, length)<br />   ◇ SELECT+SUBSTRING(password,1,1)+FROM+users+WHERE+username=&#39;admin&#39;)=CHAR<br />   ◇ Try implementing a Cluster Bomb attack, which tests every permutations for multiple payload positions. e.g. set up one for each char position &amp; character.<br />      ▪ Only through Burp Intruder PRO<br /><strong><br />Inducing conditional responses by triggering SQL errors</strong><br />• If there is no difference in behaviour when you try forced conditional responses<br />• Try triggering errors instead<br />• &#39; AND (SELECT CASE WHEN (1=2) THEN 1/0 ELSE &#39;a&#39; END)=&#39;a<br />   ◇ case is just a conditional<br />• xyz&#39; AND (SELECT CASE WHEN (Username = &#39;Administrator&#39; AND SUBSTRING(Password, 1, 1) &gt; &#39;m&#39;) THEN 1/0 ELSE &#39;a&#39; END FROM Users)=&#39;a <br /><strong><br />Triggering time delays</strong><br />• Handy BApp to install: Request Timer -&gt; or just monitor the “response recieved column” and test the highest numbers<br />• Differs by DB<br />• Now, what if errors are handled ‘gracefully’ (i.e. they aren&#39;t displayed on the screen)<br />• SQL queries occur synchronously by the app<br />• delaying will also delay HTTP response<br />• Can infer truth of injected condition based on time taken to test condition &amp; trigger a delay.<br />• &#39;; IF (1=2) WAITFOR DELAY &#39;0:0:10&#39;--<br />• Or just concatenate it on the end: &#39;||pg_sleep(10)--<br />• Same proccess as above (getting password length then doing letter by letter)<br /><strong><br />OAST</strong><br />• &quot;Out of Band Security Testing<br />• use external servers to see blind vulnerabilities<br />• improvement of DAST (Dynamic applicatoin security testing)<br />   ◇ Blind and async bugs easily missed<br />• SAST (Static application security testing)<br />   ◇ Looks at the code itself<br />   ◇ Doesn&#39;t execute any code<br />   ◇ False positives - takes time determining which in the whole list are legitimate issues.<br />• Use Burp Collaborater as a third party to Burp and the target<br />   ◇ identifies precise Burp Scanner payloads responsible for each interaction recieved.<br />TODO: Complete content and labs<br /><br /></div></body></html>