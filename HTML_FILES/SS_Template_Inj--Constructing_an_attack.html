<!doctype html><html>
    <head>
      <meta http-equiv="content-type" content="text/html; charset=utf-8">
      <title>Constructing an attack</title>
      <meta name="generator" content="CherryTree">
      <link rel="stylesheet" href="res/styles3.css" type="text/css" />
    </head>
    <body><div class='page'><h1 class='title'>Constructing an attack</h1><br/><strong>Detect</strong><br />• go unnoticed because only apparent to people looking for them.<br />• Easy to exploit (especially in unsandboxed enviornments)<br />• Try fuzzing template<br />   ◇ Inject some spcial characters: <code>${{&lt;%[%&#39;&quot;}}%\</code><br />   ◇ Any exceptions indicates suntax is interpreted by server.<br />• SSTI occur in 2 different contexts -&gt; try both<br /><br /><span style="text-decoration:underline;">Plaintext context</span><br />- freely input content in HTML tags or other<br />   → XSS too?<br />- Add mathematical expressions ({7*7})<br />   → If it evaluates to 49, it is being evaluated server-side<br />   → POC<br /><br /><span style="text-decoration:underline;">Code Context</span><br />- User input being placed within template expression.<br />- Doesn&#39;t result in obvious XSS<br />   → Easily missed SSTI<br />- CHECK: if there is XSS?<br />   → <code>http://vulnerable-website.com/?greeting=data.username&lt;tag&gt;</code><br />      ⇒ Probably get blank, encoded tags, error message = no XSS<br />- TRY: Break out of statement using templating syntax and add extra HTML<br />   → <code>http://vulnerable-website.com/?greeting=data.username}}&lt;tag&gt;</code><br />      ⇒ if blank: wrong template language syntax, try others. If you&#39;ve tried them all, injection isn&#39;t possible.<br /><br /><strong>Identify</strong><br />• Identify the template engine<br />• Submit invalid syntax to see the error message (might list the correct syntax in the error message)<br />• Process of elimination (based on correct/incorrect syntax)<br />   ◇ Don&#39;t jump to conclusions after one test, might be various templates that get the same response.<br /><br /><strong>Exploit</strong><br />• Various ways of exploiting, exploits has it&#39;s own page :)</div></body></html>