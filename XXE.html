<!doctype html><html>
    <head>
      <meta http-equiv="content-type" content="text/html; charset=utf-8">
      <title>XXE</title>
      <meta name="generator" content="CherryTree">
      <link rel="stylesheet" href="res/styles3.css" type="text/css" />
    </head>
    <body><div class='page'><h1 class='title'>XXE</h1><br/><strong>When to use &amp; vs %</strong><br />• Placing an &amp; to reference an entity will only work with entities in the same file (need to fact check this)<br />• the % symbol will refer to entities in DTD&#39;s in other systems (so you can refer an out of band dtd to load in new entities) (again... fact check this)<br /><br /><strong>What is it?</strong><br />• XML external entity injection<br />• inteferes with processing of XML data<br />• View files on application server filesystem &amp; interact<br />• Can be escalated to perform SSRF Attack<br />• They are entities that exist outside of the DTD (like creating a new tag)<br /><strong><br />How do they arise?</strong><br />• XML used as transition of data between browser and server (like JSON)<br />• Usually use a standard library/platform API to process data on the server<br /><strong><br />Types of attacks</strong><br />• Retrieve files LFI (local file inclusion)<br />• Perform SSRF attacks<br />• exfiltrate data out-of-band<br />• Retrieve data via error messages<br /><strong><br />Finding and testing for XXE</strong><br />• Look for file retrieval : define external entity based on well-known operating system file to test responses<br />• To test Blind: create an external entity URL for a system you control and monitor interactions<br />• Look at user-supplied non-XML data within server-side XML to do an XInclude attack<br />• Pick a small JSON request, try and submit it in XML format and see if it accepts it.<br />• Copy and paste from payloadallthethings<br /><strong><br />Preventing XXE Vulnerabilities</strong><br />• Most vulnerabilities arise because of applications XML parsing library supporting dangerous XML features.<br />   ◇ Disable those features that aren&#39;t used.<br />• Disable resolution of external entitties &amp; support for XInclude (config options)</div></body></html>