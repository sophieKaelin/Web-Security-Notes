<!doctype html><html>
    <head>
      <meta http-equiv="content-type" content="text/html; charset=utf-8">
      <title>Vulnerabilities</title>
      <meta name="generator" content="CherryTree">
      <link rel="stylesheet" href="res/styles3.css" type="text/css" />
    </head>
    <body><div class='page'><h1 class='title'>Vulnerabilities</h1><br/><strong>Overview</strong><br />• CSRF vulnerabilities arise due to mistakes in token validation<br />• TODO: ask jamie question in ss<br /><strong><br />Validation depends on request method</strong><br />• Some apps validate on POST but forget GET method<br />• Try switching metods to bypass validation and deliver attack<br /><strong><br />Validation depends on token being present</strong><br />• Some apps validate token when present, but skip if it isn&#39;t there<br />• Remove the csrf parameter and see if it works<br /><strong><br />Token not tied to user session</strong><br />• Some apps don&#39;t validate token belongs to same session as user making the request<br />   ◇ global pool of tokens issued and accepts any token in the pool<br />• Can log in, grab your own token, and validate any request on other peoples behalf with your own token<br />   ◇ because it belongs to that pool<br /><strong><br />Token is tied to non-session cookie</strong><br />• Invalid configuration: token should be assosicated with session management.<br />• Happens when app has 2 different frameworks<br />   ◇ 1 session handling<br />   ◇ 1 CSRF protection<br />   ◇ They should be integrated<br />• Any site that contains behaviour that allows attacker to set cookie in browser, you can attack.<br />• ATTACK:<br />   ◇ Log in and get your own cookie<br />   ◇ Set the victims cookie to your own<br />   ◇ feed your token to victim in attack.<br />   ◇ NOTE: cookie-settin can happen anywhere on DNS domain.<br />   ◇ Set-Cookie header?<br />   ◇ Set an image with src that has a param setting a cookie<br />   ◇ <code>&lt;img src=&quot;$/?search=test%0d%0aSet-Cookie:%20csrf=fake&quot;+onerror=&quot;document.forms[0].submit();&quot;/&gt;</code><strong><br />Token duplicated in a cookie</strong><br />• some apps don&#39;t maintain server-side record of tokens<br />   ◇ instead duplicate each token within a cookie and request parameter.<br />   ◇ App only verifies token in request parameter matches value submitted in cookie<br />   ◇ “Double Submit&quot;<br />   ◇ Simple to implement, avoids need of server.<br />• Attacker perform attack if site contains cookie setting functionality<br />   ◇ doesn&#39;t need to obtain their own valid token<br />   ◇ invent one with required format.<br />   ◇ Use cookie setting behaviour. Check if there is anything in the Set-Cookie header and use an XSS attack</div></body></html>