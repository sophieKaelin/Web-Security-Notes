<!doctype html><html>
    <head>
      <meta http-equiv="content-type" content="text/html; charset=utf-8">
      <title>DNS Exfil</title>
      <meta name="generator" content="CherryTree">
      <link rel="stylesheet" href="res/styles3.css" type="text/css" />
    </head>
    <body><div class='page'><h1 class='title'>DNS Exfil</h1><br/><strong>DNS-based data exfiltration</strong><br /><strong><br />Why do Targeted Threats use DNS-based Data Exfiltration?</strong><br />• Lots of things implemented in a business that inspect TCP and other network traffic protocols<br />   ◇ Firewalls, intrusion detection systems, antivirus software, data loss prevention programs<br />• DNS overlooked<br />   ◇ because not associated with data delivery<br />• Threat actors use above assumptions and complacency. Use DNS to bypass sec mechanisms<br /><strong><br />How does it work?</strong><br />• Attacker needs authoritative name server, serving their own domain<br />• attaches malware to malicious domain, and sends it across the network, returns to their domain and decrypts<br />• encoded information.<br />• Tunnel filtered protocols over DNS<br />• DNS translates URLS into IPs<br />• NS Record: maps domain name to list of DNS servers<br /><strong><br />DNS Tunneling</strong><br />• Method to send data over DNS protocol<br />   ◇ protocol was not intended for data transfer<br />• Can use Tunnelling to get free airport wifi<br />   ◇ HTTP traffic blocked until username/password provided<br />   ◇ DNS still allowed in the backrgound: just encode HTTP traffic over DNS for free access<br />   ◇ Drawback: DNS is slooooowwwwwww<br />• Bypasses network security devices (firewalls)<br /><strong><br />Blocking DNS Tunnelling</strong><br />• Various approaches<br />• Detection of known malicious domains<br />   ◇ drop naughty domains<br />   ◇ Applications such as: Cloudfare, OpenDNS, InfoBlox.<br />   ◇ Blocklist<br />• Traffic analysis<br />   ◇ reactive<br />   ◇ Have knowledge of what regular traffic looks like.<br />   ◇ detect when there is an increase in activity<br />   ◇ some applications that do this.<br />• Intrusion Prevention Systems<br />   ◇ Snort</div></body></html>