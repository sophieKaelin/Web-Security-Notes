<!doctype html><html>
    <head>
      <meta http-equiv="content-type" content="text/html; charset=utf-8">
      <title>Manipulate Traffic</title>
      <meta name="generator" content="CherryTree">
      <link rel="stylesheet" href="res/styles3.css" type="text/css" />
    </head>
    <body><div class='page'><h1 class='title'>Manipulate Traffic</h1><br/><strong>Intercept/modify messages</strong><br />• Determine whether sockets are being used (analyse traffic)<br />• Intercept tab on Burp -&gt; just modify like that<br /><strong><br />Replaying / Generating new messages</strong><br />• Send to Burp Repeater<br />• Send over and over<br /><strong><br />Manipulate Connections</strong><br />• Manipulate the handshake<br />• Enables you to reach more attack surface<br />• Drop a connection and establish a new one<br />• Tokens in OG request might be stale and need updating<br />• How to attack:<br />   ◇ Burp Repeater<br />   ◇ Pencil Icon next to WS URL.<br />      ▪ Attach existing connected WS<br />      ▪ Clone connected WS<br />      ▪ Reconnect to disconnected WS<br />   ◇ Wizrd will show details.<br /><strong><br />Manipulating message to exploit vulns</strong><br />• WebSocket History Tab under proxy (Burp)<br />• tamper with contents of messages<br />• Messages might be placed in tags (HTML)<br />• Add an XSS Payload:<br />   ◇ <code>{&quot;message&quot;:&quot;&lt;img src=1 onerror=&#39;alert(1)&#39;&gt;&quot;}</code><br /><strong><br />Manipulate Handshake to exploit vulns</strong><br />• Vulnerabilities in the design flaws<br />• Misplaced trust in headers, like X-Forwarded-For<br />   ◇ Set IP in header to 127.0.0.1 or 1.1.1.1<br />• Session-handling flaws<br />• Custom HTTP headers.<br /><br /><strong>Using XS WS to exploit vulns</strong><br />• Connect to the dodgy site to create a connection<br />• Called Cross-Site Webscoket Hijacking (section on it)<br />• Exploiting CSRF vulnerability<br />• Serious impact, privledged actions on behalf of user.</div></body></html>