<!doctype html><html>
    <head>
      <meta http-equiv="content-type" content="text/html; charset=utf-8">
      <title>Exploiting design flaws</title>
      <meta name="generator" content="CherryTree">
      <link rel="stylesheet" href="res/styles3.css" type="text/css" />
    </head>
    <body><div class='page'><h1 class='title'>Exploiting design flaws</h1><br/><strong>General</strong><br />• add cache buster at end of URL: /?cb=1234 and send twice to see if it gets cached (X-Cache: hit)<br />• Play around with headers and see if anything is reflected? <br />• Look for JS files being requested, see if you can adjust the headers so that something is reflected.<br />• Use Param Miner (Guess Headers) in Burp to determine which headers to test<br />• Maybe create fake page with the full extension of target JS and then redirect to that page using X-Host/Forwarded headers<br /><br />Vulnerabilities generally arise due to flaws in design, and with poor implementation.<br /><br /><strong>Deliver an XSS attack</strong><br />• Look for reflections in the response, and change the value of that header with an XSS payload (if they are unkeyed)<br />• a.&quot;&gt;&lt;script&gt;alert(1)&lt;/script&gt;<br /><br /><strong>Exploit unsafe handling of resource imports</strong><br />• unkeyed headers used to dynamically generate URLS for importing resources<br />• Change valud of header to domain they control<br />   ◇ Point to naughty JS<br />• If Cached, JS import/executed in browser session of any user with matched cache key.<br />• Try adding the X-Forwarded-Host header<br /><br /><strong>Exploit Cookie-Handling vulnerabilities</strong><br />• See if the cookie is reflected anywhere and add something naughty (xss?)<br />• You can put something directly in the web page, rather than caching a URL to an exploit server.<br /><br /><strong>Exploit using multiple headers</strong><br />• Look at X-Forwarded-Proto header and host? Can you use these both to deliver a malicious page?<br />• X-Forwarded-Scheme header.<br /><br /><strong>Exploit responses that expose too much info</strong><br />• Cache-control directives<br />   ◇ helpful information can be gathered from requests: how often cache purged, how old current response is (age, max-age)<br />   ◇ info enables more subtle attacks (less trial and error)<br />• Vary header<br />   ◇ specifies list of additional headers that should be treated as cache key (even if normally unkeyed)<br />   ◇ User-Agent is often in that list.<br />   ◇ use this information to see (e.g.) which user agent victims use, tailored attack (create a page that logs the user agent of people, target attack at just users with that agent)<br /><br /><strong>Exploit DOM-based vulnerabilities</strong><br />• if js used to fetch additional data from back-end, you can make it fetch something bad<br />• e.g. =&gt; fetch JSON data that will dynamically execute (but make sure you enable CORS)</div></body></html>