<!doctype html><html>
    <head>
      <meta http-equiv="content-type" content="text/html; charset=utf-8">
      <title>DIR Traversal</title>
      <meta name="generator" content="CherryTree">
      <link rel="stylesheet" href="res/styles3.css" type="text/css" />
    </head>
    <body><div class='page'><h1 class='title'>DIR Traversal</h1><br/><strong>What is it?</strong><br />• attack that allows reading of arbitrary files on server running the app<br /><strong><br />Reading Arbitrary files</strong><br />• images often at /var/www/images<br />• if no defences:<br />   ◇ <a href="https://insecure-website.com/loadImage?filename=../../../etc/passwd">https://insecure-website.com/loadImage?filename=../../../etc/passwd</a><br />• Just keep adding ../ until you get to the etc folder.<br /><strong><br />Common Obstacles</strong><br />• Try just a straight filename=/etc/passwd<br />   ◇ Might just find it.<br />• Try to use nested traversal sequences<br />   ◇ <code>....//</code><br />   ◇ <code>....\/</code><br />• Use non-standard encodings:<br />   ◇ <code>..%c0%af</code><br />   ◇ <code>..%252f</code><br />• You might need to keep part of the filepath name<br />   ◇ Try variations or keeping it there and traversing back<br />   ◇ <code>filename=/var/www/images/../../../etc/passwd</code><br />• Sometimes you&#39;ve got an expected file extension. Use null byte to terminate file path THEN add the extension<br />   ◇ <code>passwd%00.png</code><br /><strong><br />Prevention</strong><br />• avoid passing user supplied input to filesystem APIs<br />• If its unavoidable employ 2 layers of defense<br />   ◇ validate user input before processing. Against allowlist or make sure it&#39;s alphanumeric<br />   ◇ append input to base dir. Use platform filesystem API to canonicalise path<br />      ▪ Validation of canonical path sample code.<br /><code>File file = new File(BASE_DIRECTORY, userInput);<br />  if (file.getCanonicalPath().startsWith(BASE_DIRECTORY)) {<br />    // process file<br />  }</code></div></body></html>