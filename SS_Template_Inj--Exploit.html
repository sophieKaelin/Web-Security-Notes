<!doctype html><html>
    <head>
      <meta http-equiv="content-type" content="text/html; charset=utf-8">
      <title>Exploit</title>
      <meta name="generator" content="CherryTree">
      <link rel="stylesheet" href="res/styles3.css" type="text/css" />
    </head>
    <body><div class='page'><h1 class='title'>Exploit</h1><br/><span style="text-decoration:underline;">Follow this order of steps to perform an exploit</span><br /><br /><strong>Read</strong><br />• Read documentation of the template engine<br /><br /><strong>Learn Basic Template Syntax</strong><br />• Learn how to embed native code blocks<br />• E.G. Python-based Mako template<br /><code>&lt;%<br />	import os<br />	x=os.popen(&#39;id&#39;).read()<br />%&gt;<br />${x}</code><br />• How do you evaluate an expression to display on the page?<br />   ◇ {% %}<br />• How do you execute arbitrary OS commands? System()?<br />   ◇ `ls`<br />   ◇ import os module?<br />• Update stuff, make sure you know where that change would reflect.<br /><strong><br />Read about security implementations</strong><br />• Read through this in the documentation if it&#39;s there<br />• Look for other warnings -&gt; developers may not have taken notice of these, try and exploit them<br /><strong><br />Look for known exploits</strong><br />• Google for known exploits associated with the template/language (mostly template)<br /><strong><br />Explore</strong><br />• Look for “self” or “environment” objects<br />   ◇ use to generate list of objects, methods, attributes<br />• Look for other objects (created by the developer)<br />   ◇ likely to contain sensitive info or material<br />• Study objects behaviour in context of each template<br />• Doesn&#39;t have to be RCE, directory traversal is still pretty impressive (you can gain some data)<br /><strong><br />Create a custom attack</strong><br />• if there is no obvious way to exploit the vulnerability, review each function for exploitable behaviour<br /><span style="text-decoration:underline;"><br />Using an object chain</span><br />- find what variables and methods you have access to<br />- Chain arguments like that to gain access to things, or see if you can execute something through chaining<br /><span style="text-decoration:underline;"><br />Using developer-supplied objects</span></div></body></html>